# Tag — 追逐捕获

::: info 环境信息
- **PettingZoo 名称**: `simple_tag_v3`
- **智能体**: 3 Predator (🔴 捕食者) + 1 Prey (🟢 猎物)
- **障碍物**: 2 个静态障碍
- **类型**: 追逐博弈 + 速度不对称
:::

## 游戏目标

### Predator (捕食者 / 狼)
- **目标**: 追捕猎物，物理碰撞即成功
- **策略**: 猎物速度更快，必须合作包围
- **奖励**: 碰撞猎物 +10.0，每步距离惩罚 -0.1

### Prey (猎物 / 羊)
- **目标**: 逃离所有捕食者，存活
- **策略**: 利用障碍物遮挡和变向
- **奖励**: 被捕获 -10.0，出界 -1.0/步，安全存活 +0.1/步

## 观测空间

| 字段 | Predator | Prey |
|:-----|:--------:|:----:|
| `self_vel` | ✓ | ✓ |
| `self_pos` | ✓ | ✓ |
| `obstacle_0`, `obstacle_1` | ✓ (障碍物相对位置) | ✓ |
| `enemies[]` | ✓ (猎物相对位置) | ✓ (捕食者相对位置) |
| `teammates[]` | ✓ (其他捕食者) | ✗ |

::: tip Predator 观测示例
```json
{
  "self_vel": [0.12, -0.08],
  "self_pos": [0.35, 0.22],
  "obstacle_0": [-0.5, 0.3],
  "obstacle_1": [0.2, -0.6],
  "enemy_0": [-0.8, 0.15],        // 猎物的相对位置
  "teammate_0": [0.3, -0.1],      // 捕食者队友 1
  "teammate_1": [-0.2, 0.5]       // 捕食者队友 2
}
```
:::

## 奖励函数

| 角色 | 条件 | 奖励 |
|:----:|:-----|:----:|
| Predator | 碰撞猎物 | **+10.0** |
| Predator | 每步距离惩罚 | **-0.1** × dist_to_prey |
| Prey | 被捕获 | **-10.0** |
| Prey | 出界 (`|x|>1` 或 `|y|>1`) | **-1.0** / step |
| Prey | 安全存活 | **+0.1** / step |

::: danger 关键不对称性
**猎物的加速度 (accel) 比捕食者高**！

这意味着猎物在直线追逐中占优势。捕食者必须：
1. **多方包围**: 从不同方向逼近
2. **利用障碍物**: 将猎物逼入死角
3. **预判路径**: 提前拦截而非跟随
:::

## 策略

### Predator 策略
```
1. 识别猎物（最后一个 enemy 条目）
2. 追击：最小化与猎物的 dx, dy
3. 如果猎物在移动，预判拦截
4. 与队友协调，从不同方向包围
```

### Prey 策略
```
1. 识别最近的捕食者
2. 向最近捕食者的反方向逃跑
3. 严格保持在边界 [-1.0, 1.0] 内
4. 如果 |x| 或 |y| > 0.85，立即转向！
```

## 运行方式

```bash
python tag_API.py
```
